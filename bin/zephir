#!/bin/bash
if [ -z "$ZEPHIRDIR" ]; then
  ZEPHIRDIR="%ZEPHIRDIR%"
  if [[ "$ZEPHIRDIR" == "%""ZEPHIRDIR""%" ]]; then
    CURDIR=`dirname $0`
    PARENTDIR=`cd $CURDIR/..; pwd`
    if [ -f $PARENTDIR/compiler.php ]; then
      export ZEPHIRDIR=$PARENTDIR
    else
      echo "Environment variable ZEPHIRDIR is not set"
      exit 1
    fi
  fi
fi

if [ ! -r $ZEPHIRDIR/bin/zephir-parser ]; then
    echo "You didn't install. Install?"
    read ch
    case "$ch" in
        n|N|no ) return -1;
            ;;
        * ) bash $ZEPHIRDIR/install
            ;;
    esac
fi

php $ZEPHIRDIR/compiler.php $*
